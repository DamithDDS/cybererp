version: '2'
services:
  letsencrypt:
    image: linuxserver/letsencrypt
    container_name: letsencrypt
    cap_add:
      - NET_ADMIN
    environment:
      - PUID=1002
      - PGID=1002
      - TZ=Asia/Colombo
      - URL=cybergateservices.net
      - SUBDOMAINS=cybodo,
      - VALIDATION=http
      - EMAIL=cybererp@cybergateservices.net #optional
      - DHLEVEL=2048 #optional
      - ONLY_SUBDOMAINS=true #optional
      - STAGING=false #optional
    volumes:
      - /opt/cybererp/config/letsencrypt:/config
    ports:
      - 443:443
      - 80:80 #optional
    restart: unless-stopped
  postgresql:
    image: 'bitnami/postgresql:11'
    container_name: postgresql
    environment:
      - ALLOW_EMPTY_PASSWORD=yes
    volumes:
      - '/opt/cybererp/data/postgresql_data:/bitnami/postgresql'
  odoo:
    image: 'bitnami/odoo:12'
    container_name: odoo
    ports:
      - '80:8069'
      - '443:8071'
    volumes:
      - '/opt/cybererp/data/odoo_data:/bitnami'
    depends_on:
      - postgresql
      - letsencrypt
volumes:
  postgresql_data:
    driver: local
  odoo_data:
    driver: local
networks:
  cybererp-network:
    driver: bridge
    enable_ipv6: true
    ipam:
      driver: default
